require(["pace","jquery","ko","zdy","app","bootstrap",ui],function(n,t,i,r,u){var o=arguments[arguments.length-1],e,f;o.init();e=r.user.get();f=r.module().import(function(){this.openedPages=i.observableArray();this.activePage=i.observable({MenuName:""});this.openPage=function(n,i){var r=t(i.target).attr("data-json");return(i.target.nodeName==="SPAN"&&(r=t(i.target.parentNode).attr("data-json")),r===undefined)?!1:(window.openWindow(JSON.parse(r),!0),!1)};this.closePage=function(n){return window.closeWindow(n),!1};this.user=i.observable(e);this.profile=function(){window.gotoPage("/Home/UserProfile")};this.calendar=function(){window.gotoPage("/Home/Calendar")};this.inbox=function(){window.gotoPage("/Home/Inbox")};this.task=function(){window.gotoPage("/Home/Task")};this.logout=function(){r.confirm("注销账号？").done(function(){t.when(r.token.set(""),r.user.set("")).done(function(){window.location="/Index"})})};this.searchText=i.observable();this.handleSearch=function(){r.alert.info("查询功能尚未完善")};t(".search-form input").keypress(function(n){n.which===13&&f.handleSearch()})}).bind();window.setInterval(function(){var r=t(".page-content-inner div.page:visible"),n=r.find("iframe"),i;n.length>0&&n[0].style.visibility!=="hidden"&&(i=n.contents().height(),n.height(i))},200);window.openWindow=function(i,r){var s=i.PageId,c=i.MenuName,h=i.PageSrc,o,e;if(f.openedPages.remove(function(n){return n.PageId===i.PageId}),f.openedPages.unshift(i),f.activePage(i),o=t(".page-content-inner"),r===!0&&t(".page-content-inner").find("#"+i.PageId).remove(),e=o.find("#"+s),e.length===0){e=t('<div class="page" id="{pageId}"><iframe src="{pageSrc}" style="width:100%; min-height:1000px; border:none; visibility:hidden;" scrolling="no" frameborder="0"><\/iframe><\/div>'.replace("{pageId}",s).replace("{pageSrc}",h));e.find("iframe").on("load",function(){this.style.visibility=""});o.append(e)}o.find("div.page").hide();e.show();n.restart();window.location="/Home/Main#"+h;u.scrollTop()};window.onhashchange=function(n){var r=n.newURL.split("#")[1],i,u;r!==undefined&&(i=f.openedPages().find(function(n){return String(n.PageSrc).toLowerCase()===r.toLowerCase()}),i===undefined&&(u=t("#menu a[href='"+r+"']"),u.length>0&&(i=u.data("json"))),i!==undefined&&window.openWindow(i))};window.closeWindow=function(n){if(f.openedPages().length===1)return!1;f.openedPages.remove(function(t){return t.PageId===n.PageId});t(".page-content-inner").find("#"+n.PageId).remove();var i=f.openedPages()[0];window.openWindow(i)};window.gotoIndex=function(){window.location="/Index"};window.gotoPage=function(n){var u;if(n===undefined||n==="")return!1;var f=n.split("?"),e=f[0],i,r=t("#menu a[href='"+e+"']");r.length>0&&(u=r.attr("data-json"),i=JSON.parse(u));i!==undefined&&(i.PageSrc=n,window.openWindow(i,!0))};window.closePage=function(n){if(n===undefined||n==="")return!1;var u=n.split("?"),f=u[0],i,r=t("#menu a[href='"+f+"']");r.length>0&&(i=r.data("json"));i!==undefined&&(i.PageSrc=n,window.closeWindow(i))};window.toastr={error:function(n){u.showToastr("error",n,"错误提示")},warning:function(n){u.showToastr("warning",n,"警告提示")},success:function(n){u.showToastr("success",n,"成功提示")},info:function(n){u.showToastr("warning",n,"信息提示")}};window.alert={error:function(n){return u.sweetAlert({text:n,type:"error",confirmButtonClass:"btn-danger"})},warning:function(n){return u.sweetAlert({text:n,type:"warning",confirmButtonClass:"btn-danger"})},success:function(n){return u.sweetAlert({text:n,type:"success",confirmButtonClass:"btn-danger"})},info:function(n){return u.sweetAlert({text:n,type:"info",confirmButtonClass:"btn-danger"})}};window.confirm=function(n){return u.sweetAlert({text:n,allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!0,confirmButtonClass:"btn-info",cancelButtonClass:"btn-danger",type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"})};window.gotoPage("/Home/DashBoard")});